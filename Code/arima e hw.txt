library(openxlsx)
library(rminer)
library(forecast)

df = read.xlsx(xlsxFile = "bebidas.xlsx", sheet=1, skipEmptyRows = FALSE,colNames = TRUE,detectDates = TRUE)

head(df)

summary(df)

#get only the BUD column
bud_data = df[, "BUD"]

head(bud_data)

#time series
K = 7
bud_tr = ts(bud_data, frequency = K)
plot(bud_tr)


#holt winters
HW_bud = HoltWinters(bud_tr)
plot(HW_bud)


#forecast next week
nextWeekBud = forecast(HW_bud, h = 1)

plot(nextWeekBud)

head(nextWeekBud)


#STELLA

#get only the STELLA column
stella_data = df[, "STELLA"]

head(stella_data)

#time series
K = 7
stella_tr = ts(stella_data, frequency = K)
plot(stella_tr)


#holt winters
HW_stella = HoltWinters(stella_tr)
plot(HW_stella)


#forecast next week
nextWeekStella = forecast(HW_stella, h = 1)

plot(nextWeekStella)

head(nextWeekStella)





#########################################ARIMA

# MENTION LIBRARY
library(forecast)
library(openxlsx)
library(rminer)
#MAKE THE SPLIT
#GET THE DATAFRAME
df = read.xlsx(xlsxFile = "bebidas.xlsx", sheet=1, skipEmptyRows = FALSE,colNames = TRUE,detectDates = TRUE)
#NUMBER OF PREDICTIONS
NPRED=140
#MAKE IT WEAKLY
k = 7
#GET THE BUD
BUD = df$BUD
#HOLDOUT TO ORDER THE DATA, IT WILL BE A ORDER BECAUSE IT HAS TIME
H = holdout(BUD,ratio=NPRED,mode="order")
#COMPOSE THE TRAIN SET
train_set = ts(BUD[H$tr],frequency=k,start=c(2019,1,2),end=c(2020,8,13))
#MAKE THE ALGORITHMN
AR = auto.arima(train_set)
head(AR)
plot(AR)
#MAKE THE FORECAST, THE 1 REPRESENTS THE WEAK
result_stella = forecast(AR,1)
#MAKE THE PLOT
plot(result_stella)


#STELLA

#NUMBER OF PREDICTIONS
NPRED=140
#MAKE IT WEAKLY
k = 7
#GET THE BUD
STELLA = df$STELLA
#HOLDOUT TO ORDER THE DATA, IT WILL BE A ORDER BECAUSE IT HAS TIME
H_stella = holdout(STELLA,ratio=NPRED,mode="order")
#COMPOSE THE TRAIN SET
train_set_stella = ts(STELLA[H_stella$tr],frequency=k,start=c(2019,1,2),end=c(2020,8,13))
#MAKE THE ALGORITHMN
AR_stella = auto.arima(train_set_stella)
#MAKE THE FORECAST, THE 1 REPRESENTS THE WEAK
result_stella = forecast(AR_stella,1)
#MAKE THE PLOT
plot(result_stella)